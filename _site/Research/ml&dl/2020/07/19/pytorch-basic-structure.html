<!DOCTYPE html>
<html class="no-js">
<head>
	<meta charset="utf-8">
	<title>(PyTorch) Basic Steps for Training a Model | Park's Archive</title>
	<meta name="description"
		content="PyTorch is one of the most well-known deep learning frameworks as well as Tensorflow. This post will describe the basic steps for traing a model with PyTorch...">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" href="/assets/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="/research/ml&dl/2020/07/19/pytorch-basic-structure.html">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Park's Archive"
		href="/feed.xml" />

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
		integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet"
		type="text/css">
	

	<!-- KaTeX -->
	
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css"
		integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">

	<script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"
		integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ"
		crossorigin="anonymous"></script>
	

	<!-- Google Analytics -->
	
	<script>
		(function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'UA-151012240-1', 'auto');
		ga('send', 'pageview');
	</script>
	
</head>
<header class="site-header">
	<div class="branding">
		
		<h1 class="site-title">
			<a href="/">Park's Archive</a>
		</h1>

		<nav class="site-nav">
			<ul>
				
				

				<!-- Search bar -->
				
				<li>
					<form action="/search.html" method="get">
						<input type="text" id="search-box" name="query" placeholder="Search" class="">
						<button type="submit" class="">
							<i class="fa fa-fw fa-search"></i>
						</button>
					</form>
				</li>
				

				<!-- Social icons from Font Awesome, ifenabled  -->
				
<li>
	<a href="/feed.xml" title="Follow RSS feed">
		<i class="fas fa-fw fa-rss"></i>
	</a>
</li>



<li>
	<a href="mailto:jhyun0919@utexas.edu" title="Email">
		<i class="fas fa-fw fa-envelope"></i>
	</a>
</li>









<li>
	<a href="https://www.facebook.com/park.jhyun0919" title="Follow on Facebook">
		<i class="fab fa-fw fa-facebook"></i>
	</a>
</li>





<li>
	<a href="https://github.com/jhyun0919" title="Follow on GitHub">
		<i class="fab fa-fw fa-github"></i>
	</a>
</li>





<li>
	<a href="http://instagram.com/park._.shape" title="Follow on Instagram">
		<i class="fab fa-fw fa-instagram"></i>
	</a>
</li>



<li>
	<a href="https://www.linkedin.com/in/jhyun0919/" title="Follow on LinkedIn">
		<i class="fab fa-fw fa-linkedin"></i>
	</a>
</li>
























			</ul>
		</nav>
	</div>

	<div class="site-category">
		<ul class='cat1'>
			<li>
				<a href="/">Home</a>
			</li>

			<li>
				<a href="/">Research</a>
				<ul>
					<li>
						<a href="/Research/Energy">Energy</a>
					</li>
					<li>
						<a href="/Research/Mathematics">Mathematics</a>
					</li>
					<li>
						<a href="/Research/ML&DL">ML & DL</a>
					</li>
					<li>
						<a href="/Research/RL">RL</a>
					</li>
				</ul>
			</li>

			<li>
				<a href="/">Daily</a>
				<ul>
					<li>
						<a href="/Daily/English">English</a>
					</li>
					<li>
						<a href="/Daily/Essay">Essay</a>
					</li>
				</ul>
			</li>

			<li>
				<a href="/about">About</a>
			</li>

		</ul>
	</div>

</header>

<body>
  <div class="content">
    <article >
  <header style="background-image: url('/')">
    <h1 class="title">(PyTorch) Basic Steps for Training a Model</h1>
    
    <p class="meta" >
      July 19, 2020
      
    </p>
  </header>
  <section class="post-content" style="width:66%; margin:0 auto;"><p>PyTorch is one of the most well-known deep learning frameworks as well as Tensorflow. This post will describe the basic steps for traing a model with PyTorch. Briefly, the basic steps of how to train a model are as follow.</p>

<ol>
  <li>Load &amp; pre-process the dataset</li>
  <li>Set a model</li>
  <li>Set an optimizer &amp; a loss function</li>
  <li>Train the model</li>
  <li>Evaluate the model</li>
</ol>

<p>Full code can be found at the following github repository.</p>
<ul>
  <li><a href="https://github.com/jhyun0919/deep_dive_into_pytorch/blob/master/tutorials/01.%20basic/pytorch%20basic%20structure.ipynb">Park’s GitHub &gt; Basic Structure of Training a Model</a></li>
</ul>

<p>This post was written with reference to the following materials.</p>
<ul>
  <li><a href="https://medium.com/@inmoonlight/pytorch%EB%A1%9C-%EB%94%A5%EB%9F%AC%EB%8B%9D%ED%95%98%EA%B8%B0-intro-afd9c67404c3">JiHyung Moon’s Meduim Posting</a></li>
  <li><a href="https://pytorch.org/tutorials/intermediate/tensorboard_tutorial.html">PyTorch official webpage &gt; Tutorials &gt; Visualizing Models, Data, and Training with TensorBoard</a></li>
</ul>

<hr />

<h1 id="1-load--pre-process-the-dataset">1. Load &amp; pre-process the dataset</h1>

<p>We used the <em>FashionMNIST</em> dataset for the experiment. The dataset can be downloaded through <em>torchvision.datasets</em>, and preprocessing can be performed through <em>transforms.Compose</em>.</p>

<p align="center">  <script src="https://gist.github.com/jhyun0919/6bd4ac356c46bfc7efe42e664ab83403.js"></script>
<br /></p>

<h1 id="2-set-a-model">2. Set a model</h1>

<p>We constructed a simple convolutional neural network model.</p>

<p align="center">  <script src="https://gist.github.com/jhyun0919/5023e2b1d56c0fe89961ba09ef192476.js"></script>
<br /></p>

<h1 id="3-set-optimizer--loss-function">3. Set optimizer &amp; loss function</h1>

<p>We set the optimizer and loss function to train the model constructed in the previous step. The optimizer and loss function types were selected according to the type of the features of the given input data and the purpose of the model.</p>

<p align="center">  <script src="https://gist.github.com/jhyun0919/e916c7736f96b4c5df111d81bece262e.js"></script>
<br /></p>

<h1 id="4-train-the-model">4. Train the model</h1>

<p>In order to train a model, we must follow the following 5 steps.</p>

<ol>
  <li>initialize the gradient</li>
  <li>forward propagation</li>
  <li>calculate the loss</li>
  <li>backward propagation</li>
  <li>optimize (update) the weights based on forward &amp; backward propagation</li>
</ol>

<p align="center">  <script src="https://gist.github.com/jhyun0919/93422cef8d6be9df23b2c8ecc55dc918.js"></script>
<br /></p>

<h1 id="5-evaluate-the-model">5. Evaluate the model</h1>

<p>We used the validation dataset to measure the performance of the completed training model. Note that the evaluate process is very similar to the training process. However, in the evaluate process, <em>torch.no_grad()</em> is required because the weights must never change.</p>

<p align="center">  <script src="https://gist.github.com/jhyun0919/5cb29e6e63d6c0a68a70742b2a1eba9d.js"></script>
</p>

</section>

  <br>
  <br>
  <br>
  
<footer>
  <div class="tags">
    
    <a class="tag" href="/tags#ML%26DL">#ML&DL</a>
    
    <a class="tag" href="/tags#PyTorch">#PyTorch</a>
    
  </div>
</footer>


</article>

<!-- Disqus -->

<div class="comments">
  <div id="disqus_thread"></div>
<script>

/**
*  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
*  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
/*
var disqus_config = function () {
this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
};
*/
(function() { // DON'T EDIT BELOW THIS LINE
var d = document, s = d.createElement('script');
s.src = 'https://park-archive.disqus.com/embed.js';
s.setAttribute('data-timestamp', +new Date());
(d.head || d.body).appendChild(s);
})();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
                            
</div>


<!-- Post navigation -->


  </div>
  
<script src="/assets/js/katex_init.js"></script>



<footer class="site-footer">
	<p class="text">Powered by <a href="https://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/rohanchandra/type-theme">Type Theme</a>
</p>
</footer>


</body>

</html>

<!-- <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
  </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
  type="text/javascript"></script> -->