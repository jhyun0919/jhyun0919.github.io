<!DOCTYPE html>
<html class="no-js">
<head>
	<meta charset="utf-8">
	<title>(TF) Which Layer Do I Need? | Park's Archive</title>
	<meta name="description"
		content="The structure of the deep learning model is designed differently depending on the types of data features and the objective of the model. More specifically, i...">
	<meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- CSS -->
	<link rel="stylesheet" href="/assets/css/main.css">

	<!--Favicon-->
	<link rel="shortcut icon" href="/assets/favicon.ico" type="image/x-icon">

	<!-- Canonical -->
	<link rel="canonical" href="/research/ml&dl/2020/07/20/how-to-choose-layer.html">

	<!-- RSS -->
	<link rel="alternate" type="application/atom+xml" title="Park's Archive"
		href="/feed.xml" />

	<!-- Font Awesome -->
	<link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.8.2/css/all.css"
		integrity="sha384-oS3vJWv+0UjzBfQzYUhtDYW+Pj2yciDJxpsK1OYPAYjqT085Qq/1cq5FLXAZQ7Ay" crossorigin="anonymous">

	<!-- Google Fonts -->
	
	<link href="//fonts.googleapis.com/css?family=Source+Sans+Pro:400,700,700italic,400italic" rel="stylesheet"
		type="text/css">
	

	<!-- KaTeX -->
	
	<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.css"
		integrity="sha384-yFRtMMDnQtDRO8rLpMIKrtPCD5jdktao2TV19YiZYWMDkUR5GQZR/NOVTdquEx1j" crossorigin="anonymous">

	<script src="https://cdn.jsdelivr.net/npm/katex@0.10.2/dist/katex.min.js"
		integrity="sha384-9Nhn55MVVN0/4OFx7EE5kpFBPsEMZxKTCnA+4fqDmg12eCTqGi6+BB2LjY8brQxJ"
		crossorigin="anonymous"></script>
	

	<!-- Google Analytics -->
	
	<script>
		(function (i, s, o, g, r, a, m) {
		i['GoogleAnalyticsObject'] = r; i[r] = i[r] || function () {
			(i[r].q = i[r].q || []).push(arguments)
		}, i[r].l = 1 * new Date(); a = s.createElement(o),
			m = s.getElementsByTagName(o)[0]; a.async = 1; a.src = g; m.parentNode.insertBefore(a, m)
		})(window, document, 'script', '//www.google-analytics.com/analytics.js', 'ga');

		ga('create', 'UA-151012240-1', 'auto');
		ga('send', 'pageview');
	</script>
	
</head>
<header class="site-header">
	<div class="branding">
		
		<h1 class="site-title">
			<a href="/">Park's Archive</a>
		</h1>

		<nav class="site-nav">
			<ul>
				
				

				<!-- Search bar -->
				
				<li>
					<form action="/search.html" method="get">
						<input type="text" id="search-box" name="query" placeholder="Search" class="">
						<button type="submit" class="">
							<i class="fa fa-fw fa-search"></i>
						</button>
					</form>
				</li>
				

				<!-- Social icons from Font Awesome, ifenabled  -->
				
<li>
	<a href="/feed.xml" title="Follow RSS feed">
		<i class="fas fa-fw fa-rss"></i>
	</a>
</li>



<li>
	<a href="mailto:jhyun0919@utexas.edu" title="Email">
		<i class="fas fa-fw fa-envelope"></i>
	</a>
</li>









<li>
	<a href="https://www.facebook.com/park.jhyun0919" title="Follow on Facebook">
		<i class="fab fa-fw fa-facebook"></i>
	</a>
</li>





<li>
	<a href="https://github.com/jhyun0919" title="Follow on GitHub">
		<i class="fab fa-fw fa-github"></i>
	</a>
</li>





<li>
	<a href="http://instagram.com/park._.shape" title="Follow on Instagram">
		<i class="fab fa-fw fa-instagram"></i>
	</a>
</li>



<li>
	<a href="https://www.linkedin.com/in/jhyun0919/" title="Follow on LinkedIn">
		<i class="fab fa-fw fa-linkedin"></i>
	</a>
</li>
























			</ul>
		</nav>
	</div>

	<div class="site-category">
		<ul class='cat1'>
			<li>
				<a href="/">Home</a>
			</li>

			<li>
				<a href="/">Research</a>
				<ul>
					<li>
						<a href="/Research/CS">CS</a>
					</li>
					<li>
						<a href="/Research/Meeting Log">Dr. Zhu's Group Meeting</a>
					</li>
					<li>
						<a href="/Research/Energy">Energy</a>
					</li>
					<li>
						<a href="/Research/Mathematics">Mathematics</a>
					</li>
					<li>
						<a href="/Research/ML&DL">ML & DL</a>
					</li>
					<li>
						<a href="/Research/RL">RL</a>
					</li>
				</ul>
			</li>

			<li>
				<a href="/">Daily</a>
				<ul>
					<li>
						<a href="/Daily/Essay">Essay</a>
					</li>
					<li>
						<a href="/Daily/Travel">Travel</a>
					</li>
				</ul>
			</li>

			<li>
				<a href="/about">About</a>
			</li>


		</ul>
	</div>

</header>

<body>
  <div class="content">
    <article >
  <header style="background-image: url('/')">
    <h1 class="title">(TF) Which Layer Do I Need?</h1>
    
    <p class="meta">
      July 20, 2020
      
    </p>
  </header>
  <section class="post-content" style="width:77%; margin:0 auto;">
    <p>The structure of the deep learning model is designed differently depending on the types of data features and the objective of the model. More specifically, in order to select the type of layer used in the model, the characteristics of data features and the learning objectives of the model must be considered.</p>

<p>In order to find out which structure is most suitable, we experimented with fixing the type of dataset and the target of the model and changing the structure of the model. The dataset used in the experiment is MNIST. The types of models used in the experiment were as follows; <em>DenseNet</em> using only <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Dense">dense layer</a>, <em>ConvNet</em> using <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/Conv2D">convolutional layer</a>, and <em>LstmNet</em> using <a href="https://www.tensorflow.org/api_docs/python/tf/keras/layers/LSTM">LSTM layer</a>.</p>

<p>Full code of the experiments can be found at the following github repository.</p>
<ul>
  <li><a href="https://github.com/jhyun0919/deep_dive_into_tensorflow/blob/master/tutorials/MNIST/how%20to%20choose%20layer.ipynb">Park’s GitHub &gt; How to choose layer</a></li>
</ul>

<p>This post was written with reference to the following materials.</p>
<ul>
  <li><a href="https://github.com/aymericdamien/TensorFlow-Examples/blob/master/tensorflow_v2/notebooks/3_NeuralNetworks/neural_network.ipynb">Aymeric Damien’s GitHub &gt; Neural Network Example</a></li>
  <li><a href="https://github.com/aymericdamien/TensorFlow-Examples/blob/master/tensorflow_v2/notebooks/3_NeuralNetworks/convolutional_network.ipynb">Aymeric Damien’s GitHub &gt; Convolutional Neural Network Example</a></li>
  <li><a href="https://towardsdatascience.com/intuitively-understanding-convolutions-for-deep-learning-1f6f42faee1">Irhum Shafkat’s Medium posting &gt; Intuitively Understanding Convolutions for Deep Learning</a></li>
  <li><a href="https://github.com/aymericdamien/TensorFlow-Examples/blob/master/tensorflow_v2/notebooks/3_NeuralNetworks/recurrent_network.ipynb">Aymeric Damien’s GitHub &gt; Recurrent Neural Network Example</a></li>
  <li><a href="https://www.simplilearn.com/tutorials/deep-learning-tutorial/rnn">Simplilearn &gt; Recurrent Neural Network Tutorial</a></li>
  <li><a href="https://www.slideshare.net/JiHyunPark18/understanding-lstm-and-its-diagrams">Park’s SlideShare &gt; Understanding LSTM</a></li>
</ul>

<hr />
<h1 id="model-structures">Model Structures</h1>
<h2 id="dense-model">Dense Model</h2>

<p>This model consisted only of dense layers. This is the simplest model of the neural network and works well for all types of data, but performance decreases when an input data becomes complicated or large. Therefore, dense layers are used in learning simple data. In addition, in the case of learning complex data, dense layers are used in the last part of the model, which is the stage where features are extracted and get simple enough.</p>

<p align="center">  <script src="https://gist.github.com/jhyun0919/ff71e7f4416a2add611074ad39888eab.js"></script>
<br /></p>

<h2 id="cnn-model">CNN Model</h2>

<p>This model consisted of convolutional layers. This model is suitable when there are spatial relationship across the data. Figure 1 depicts how a convolutional layer works, and it helps understand why this model works well when there are spatial relationship across data.</p>

<p align="center">  <script src="https://gist.github.com/jhyun0919/1043aeb7181b81ac0106d0bbcc0f74d3.js"></script>
</p>

<figure align="center">
<img src="https://jhyun0919.github.io/assets/img/2020-07-20-how to choose layer/cnn visualized.gif" width="50%" />   <figcaption>
Figure 1. Visualization of how the convolutional neural network layer works [1].
  </figcaption>
</figure>
<p><br /></p>

<h2 id="rnnlstm-model">RNN(LSTM) Model</h2>

<p>This model consisted of LSTM layers. This model is suitable when there are temporal (sequential) relationship across the data. Figure 2 depicts how a LSTM layer works, and it helps understand why this model works well when there are temporal relationship across data.</p>

<p align="center">  <script src="https://gist.github.com/jhyun0919/f6d3f2c79049c74b6a74b6b792e20ba7.js"></script>
</p>

<figure align="center">
<img src="https://jhyun0919.github.io/assets/img/2020-07-20-how to choose layer/rnn visualized.gif" width="60%" />   <figcaption>
Figure 2. Visualization of how the recurrent neural network layer works [2].
  </figcaption>
</figure>
<p><br /></p>

<h1 id="experiment-result">Experiment Result</h1>

<p>As a result of the experiment, the CNN model using a convolutional layer showed the highest performance for learning MNIST image data. Direct comparison was not possible because the number of trainable parameters differed for each model, but the result was obtained by adjusting hyper-parameters to obtain the best performance for each model.</p>

<p>To sum up, we have confirmed that it is best to use a convolutional layer when learning MNIST image data.</p>

<table>
  <thead>
    <tr>
      <th style="text-align: right"> </th>
      <th style="text-align: right">Accuracy</th>
      <th style="text-align: right">Loss</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td style="text-align: right">DenseNet</td>
      <td style="text-align: right">0.9556</td>
      <td style="text-align: right">1.5092</td>
    </tr>
    <tr>
      <td style="text-align: right"><strong>ConvNet</strong></td>
      <td style="text-align: right"><strong>0.9817</strong></td>
      <td style="text-align: right"><strong>1.4793</strong></td>
    </tr>
    <tr>
      <td style="text-align: right">LstmNet</td>
      <td style="text-align: right">0.9603</td>
      <td style="text-align: right">1.5015</td>
    </tr>
  </tbody>
</table>

<figure align="center">
<img src="https://jhyun0919.github.io/assets/img/2020-07-20-how to choose layer/tensorboard result.png" width="95%" />   <figcaption>
Figure 2. Checking the validation result with tensorboard.
  </figcaption>
</figure>
<p><br /></p>

<h1 id="future-study">Future Study</h1>

<p>In some cases, such as image data or stock data, we can know the nature of the feature data in advance and use the CNN or RNN layers respectively. However, it is difficult to fully understand the charactieristic of completely new feature data. In this case, it is difficult to make assumptions about the temporal/spatial relationships across the data. As a result, it is not easy to decide which layer to use.</p>

<p><a href="https://www.tensorflow.org/tutorials/text/transformer">Transformer</a> is a model designed to solve this problem. Transformer is a model based on attention, it make no assumptions about the temporal/spatial relationships across the data [3]. In the next posting, we will discuss the structure and application of the Transformer.</p>

<p><br /></p>

<h1 id="reference">Reference</h1>

<p>[1]I. Shafkat, “Intuitively Understanding Convolutions for Deep Learning,” Medium, 07-Jun-2018. [Online]. Available: https://towardsdatascience.com/intuitively-understanding-convolutions-for-deep-learning-1f6f42faee1. [Accessed: 23-Jul-2020].</p>

<p>[2] A. Biswal, “Recurrent Neural Network Tutorial,” Simplilearn.com, 28-Apr-2020. [Online]. Available: https://www.simplilearn.com/tutorials/deep-learning-tutorial/rnn. [Accessed: 23-Jul-2020].</p>

<p>[3] “Transformer model for language understanding : TensorFlow Core,” TensorFlow. [Online]. Available: https://www.tensorflow.org/tutorials/text/transformer. [Accessed: 23-Jul-2020].</p>

  </section>

  <br>
  <br>
  <br>
  
<footer>
  <div class="tags">
    
    <a class="tag" href="/tags#ML%26DL">#ML&DL</a>
    
    <a class="tag" href="/tags#MNIST">#MNIST</a>
    
    <a class="tag" href="/tags#CNN">#CNN</a>
    
    <a class="tag" href="/tags#RNN">#RNN</a>
    
  </div>
</footer>

</article>

<!-- Disqus -->

<div class="comments">
  <div id="disqus_thread"></div>
<script>

    /**
    *  RECOMMENDED CONFIGURATION VARIABLES: EDIT AND UNCOMMENT THE SECTION BELOW TO INSERT DYNAMIC VALUES FROM YOUR PLATFORM OR CMS.
    *  LEARN WHY DEFINING THESE VARIABLES IS IMPORTANT: https://disqus.com/admin/universalcode/#configuration-variables*/
    /*
    var disqus_config = function () {
    this.page.url = PAGE_URL;  // Replace PAGE_URL with your page's canonical URL variable
    this.page.identifier = PAGE_IDENTIFIER; // Replace PAGE_IDENTIFIER with your page's unique identifier variable
    };
    */
    (function () { // DON'T EDIT BELOW THIS LINE
        var d = document, s = d.createElement('script');
        s.src = 'https://park-archive.disqus.com/embed.js';
        s.setAttribute('data-timestamp', +new Date());
        (d.head || d.body).appendChild(s);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by
        Disqus.</a></noscript>
</div>


<!-- Post navigation -->

  </div>
  
<script src="/assets/js/katex_init.js"></script>



<footer class="site-footer">
	<p class="text">Powered by <a href="https://jekyllrb.com/">Jekyll</a> with <a href="https://github.com/rohanchandra/type-theme">Type Theme</a>
</p>
</footer>


</body>

</html>

<!-- <script type="text/x-mathjax-config">
  MathJax.Hub.Config({
    tex2jax: {
      inlineMath: [['$','$'], ['\\(','\\)']],
      processEscapes: true
    }
  });
  </script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"
  type="text/javascript"></script> -->